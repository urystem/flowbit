1. 

üö∂‚Äç‚ôÇÔ∏è –û–±—ã—á–Ω—ã–π for + Exec

for _, v := range data {
    _, err := db.Exec(ctx,
        `INSERT INTO table (a, b) VALUES ($1, $2)`,
        v.A, v.B,
    )
    if err != nil {
        return err
    }
}

–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ–∞–ª—å–Ω–æ:

–ö–∞–∂–¥—ã–π Exec() ‚Üí –æ—Ç–¥–µ–ª—å–Ω—ã–π SQL-–∑–∞–ø—Ä–æ—Å.

–ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å ‚Üí –æ—Ç–¥–µ–ª—å–Ω—ã–π round-trip –ø–æ —Å–µ—Ç–∏:

–∫–ª–∏–µ–Ω—Ç ‚Üí —Å–µ—Ä–≤–µ—Ä (SQL)

—Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç (–æ—Ç–≤–µ—Ç)

–ï—Å–ª–∏ —É —Ç–µ–±—è 1000 —Å—Ç—Ä–æ–∫, —Ç–æ —ç—Ç–æ 1000 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥.
–î–∞–∂–µ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ localhost ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.


2.
‚ö° pgx.Batch
batch := &pgx.Batch{}
for _, v := range data {
    batch.Queue(`INSERT INTO table (a, b) VALUES ($1, $2)`, v.A, v.B)
}
br := db.SendBatch(ctx, batch)
for range data {
    if _, err := br.Exec(); err != nil {
        return err
    }
}
–ß—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –¥–µ–ª–∞–µ—Ç:

pgx —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–≤–æ–∏ INSERT –≤ –æ—á–µ—Ä–µ–¥—å (–≤ –ø–∞–º—è—Ç–∏ Go).

–ü—Ä–∏ SendBatch() ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å—é –æ—á–µ—Ä–µ–¥—å –æ–¥–Ω–∏–º –±–æ–ª—å—à–∏–º –ø–∞–∫–µ—Ç–æ–º.
–¢–æ –µ—Å—Ç—å 1000 –∫–æ–º–∞–Ω–¥ —É—Ö–æ–¥–∏—Ç –æ–¥–Ω–∏–º round-trip‚Äô–æ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

–°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ–º –∂–µ –ø–æ—Ç–æ–∫–æ–º.



3 

‚ùå –ù–µ—Ç, tx (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è) –Ω–µ –¥–µ–ª–∞–µ—Ç –≤—Å—ë –æ–¥–Ω–∏–º round-trip‚Äô–æ–º.
‚úÖ –û–Ω–∞ –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–∂–∏—Ç –æ–¥–Ω–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º –∏ –Ω–µ –¥–µ–ª–∞–µ—Ç COMMIT –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –≤—Å—Ç–∞–≤–∫–∏.

